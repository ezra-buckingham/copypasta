<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="assets/materialize/css/materialize.min.css">

    <title>CopyPasta</title>

    {% raw %}
    <style>
    table.striped>tbody>tr:nth-child(odd) {
        background-color: rgba(46, 50, 50, 255)
    }
    </style>
    {% endraw %}

</head>

<body>
    <nav class="nav-extended red">
        <div class="nav-wrapper container">
            <a href="#" class="brand-logo">CopyPasta</a>
        </div>
        <div class="nav-content container">
            <ul id="nav-tabs" class="tabs tabs-transparent row">
              <li class="tab col s4"><a href="#files">Files</a></li>
              <li class="tab col s4"><a href="#functions">Shell Functions</a></li>
              <li class="tab col s4"><a href="#help">Help</a></li>
            </ul>
            <a data-target="add-text" class="btn-floating btn-large halfway-fab waves-effect waves-light green modal-trigger">
                <i class="material-icons">note_alt</i>
            </a>
            <form id="file-upload" action="./upload" method="post" enctype="multipart/form-data">
                <span style="margin-right: -70px;" class="btn-floating btn-large halfway-fab waves-effect waves-light blue btn-file">
                    <i class="material-icons">attach_file</i>
                    <input id="file" type="file" name="upload">
                </span>
            </form>
        </div>
    </nav>
        
        
    <div class="container">

        <div id="add-text" class="modal">
            <div class="modal-content">
                <h4>Add Content</h4>
                <div class="col s8">
                    <form id="text-submit" action="./index" method="post">
                        <div class="input-field">
                            <textarea class="materialize-textarea" id="text-content" name="text" rows="5" cols="30">{{ text }}</textarea>
                            <label for="text">Your content here...</label>
                        </div>
                        <div class="row">
                            <button class="waves-effect waves-light btn center blue" name="paste" id="paste-clipboard" type="button" onclick="pasteContent()" 
                                title="Paste text to this input area"><i class="material-icons left">content_paste</i>Paste Clipboard</button>
                            <button class="waves-effect waves-light btn center green" name="save_text" type="submit"
                                title="Save pasted text as a file available for download"><i class="material-icons left">feed</i>Save as Text</button>
                            <button class="waves-effect waves-light btn center teal" name="save_b64" type="submit"
                                title="Save a base64-encoded blob as a file available for download"><i class="material-icons left">data_object</i>Save as B64</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

        <div id="upload" class="modal">
            <div class="modal-content">
                <h4>Upload</h4>
                <div class="row">
                    <form action="./index" method="post" enctype="multipart/form-data">
                        <span class="btn btn-file">
                            <i class="material-icons left">cloud_upload</i>
                            Browse Files<input type="file">
                            </button>
                        </span>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <a href="#!" class="modal-close waves-effect btn-flat">Close</a>
            </div>
        </div>
    

        <div id="files">
            <h2>Files</h2>
            {% if files %}
            <table class="striped highlight responsive-table">
                <thead>
                    <tr>
                        <th>File</th>
                        <th class="center">Download</th>
                        <th class="center">Preview</th>
                        <th class="center">To Base64</th>
                        <th>Size</th>
                        <th>Date</th>
                        <th>MD5</th>
                        <th class="center">Remove</th>
                    </tr>
                </thead>
                {% for file in files %}
                <tr s>
                    <td><pre>{{ file[0] }}</pre></td>
                    <td class="center"><a class="btn btn-floating waves-effect blue" href="uploads/{{ file[0] }}?type=raw" download> <i class="material-icons">download</i></a></td>
                    <td class="center"><a class="btn btn-floating waves-effect green" href="uploads/{{ file[0] }}?type=raw"><i class="material-icons">visibility</i></a></td>
                    <td class="center"><a class="btn btn-floating waves-effect yellow" href="uploads/{{ file[0] }}?type=b64"><i class="material-icons">code</i></a></td>
                    <td>{{ file[1] }}</td>
                    <td>{{ file[2] }}</td>
                    <td><pre>{{ file[3] }}</pre></td>
                    <td class="center"><a class="btn btn-floating waves-effect red" href="remove/{{ file[0] }}" onclick="return confirm('Remove {{ file[0] }}?')"><i class="material-icons">delete_forever</i></a></td>
                </tr>
                {% endfor %}
            </table>
            {% endif %}
        </div>

        <div id="functions">
            <h3>Shell Functions</h3>
            <p>Some helper functions for you</p>

            <h4>Curl Upload</h4>
            <pre>curl -F text="your text here" {{ host }}</pre>
            <pre>curl -F text="$(cat file.txt)" {{ host }}</pre>

            <h4>Curl Download</h4>
            <pre>curl {{ host }}/&lt;index&gt; -L -o &lt;filename&gt;</pre>

            <h4>Copy Content</h4>
            <pre>curl {{ host }}/clipboard | xclip -selection clipboard</pre>

            <h4>CopyPasta from Remote Host (SSH)</h2>
            <pre>ssh user@remote-host -R 8000:{{ host }}</pre>
        </div>

        <div id="help">
            <h3>Helpers</h3>
            <pre>
# ~/.bashrc functions 
export COPYPASTA="{{ host }}"

copy () {
    curl $COPYPASTA/clipboard -s | xclip -selection clipboard
}

paste () {
    local input=""
    if [[ -p /dev/stdin ]]; then
        input="$(cat -)"
    else
        input="${@}"
    fi
    curl -F text="$input" $COPYPASTA
}

upload () {
    curl -F upload=@"$1" $COPYPASTA -s
    echo "[*] Uploaded $1 to $COPYPASTA."
}

download () {
    curl $COPYPASTA/$1 -L -o $2
}

downloads () {
    if [ "$1" = "-a" ] || [ "$1" = "--all" ]; then
        DETAILS="true"
    else
        DETAILS="false"
    fi
    curl $COPYPASTA/list?details=$DETAILS
}

            </pre>
        </div>

    <br>
    

    </div>

    <!--JavaScript at end of body for optimized loading-->
    <!--JavaScript at end of body for optimized loading-->
    <script type="text/javascript" src="assets/materialize/js/materialize.min.js"></script>

    <script>
        document.getElementById("file").onchange = function() {
            document.getElementById("file-upload").submit();
        };

        document.addEventListener('DOMContentLoaded', function() {
            M.AutoInit();

            var add_modal = document.querySelector('#add-text');
            var add_modal_options = {};
            var add_modal_obj = M.Modal.init(add_modal, add_modal_options);

            var upload_modal = document.querySelector('#upload');
            var upload_modal_options = {};
            var upload_modal_obj = M.Modal.init(upload_modal, upload_modal_options);

            var tabs = document.querySelector('#nav-tabs');
            var tabs_options = {};
            var tabs_obj = M.Tabs.init(tabs, tabs_options);

            var action_btn = document.querySelectorAll('#action-btn');
            var action_btn_options = {}
            var action_btn_obj = M.FloatingActionButton.init(action_btn, action_btn_options);
        });

        
    </script>
</body>

</html>